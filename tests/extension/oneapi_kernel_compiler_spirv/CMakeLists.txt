function(load_spirv SPIRV_FILE RESULT)
    file(READ ${SPIRV_FILE} bytes HEX)
    string(REGEX REPLACE "([0-9a-f][0-9a-f])" "0x\\1, " values ${bytes})
    string(REGEX REPLACE ", $" "" values ${values})
    set(${RESULT} ${values} PARENT_SCOPE)
endfunction()

if(SYCL_CTS_ENABLE_EXT_ONEAPI_KERNEL_COMPILER_SPIRV_TESTS)
    file(GLOB test_cases_list *.cpp)

    load_spirv("${CMAKE_CURRENT_SOURCE_DIR}/kernels.spv" KERNELS)
    load_spirv("${CMAKE_CURRENT_SOURCE_DIR}/kernels_fp16.spv" KERNELS_FP16)
    load_spirv("${CMAKE_CURRENT_SOURCE_DIR}/kernels_fp64.spv" KERNELS_FP64)
    file(WRITE "${CMAKE_CURRENT_BINARY_DIR}/kernels.inc" ${KERNELS})
    file(WRITE "${CMAKE_CURRENT_BINARY_DIR}/kernels_fp16.inc" ${KERNELS_FP16})
    file(WRITE "${CMAKE_CURRENT_BINARY_DIR}/kernels_fp64.inc" ${KERNELS_FP64})
    include_directories("${CMAKE_CURRENT_BINARY_DIR}")

    add_cts_test(${test_cases_list})
endif()
